import"./svelte/svelte_internal_flags_legacy.js";import"./svelte/svelte_internal_flags_async.js";import*as e from"./svelte/svelte_internal_client.js";import{createEventDispatcher as R}from"./svelte/svelte_svelte.js";import"./i18n-DMKL1Q3B.js";import{u as X}from"./utils.svelte-Ceck75cM.js";import{b as Y,d as B,E as C,c as A,j as G,I as J,D as K}from"./IconButtonWrapper-BWheMLkN.js";import{S as Q}from"./ShareButton-DLehHS0O.js";import{F as U}from"./FullscreenButton-B8JPMBMa.js";import{I as V}from"./Image-Bdf4wQSw.js";const Z=c=>{let r;if(c.currentTarget instanceof Element)r=c.currentTarget.querySelector("img");else return[NaN,NaN];const a=r.getBoundingClientRect(),i=r.naturalWidth/a.width,s=r.naturalHeight/a.height;if(i>s){const n=r.naturalHeight/i,f=(a.height-n)/2;var l=Math.round((c.clientX-a.left)*i),_=Math.round((c.clientY-a.top-f)*i)}else{const n=r.naturalWidth/s,f=(a.width-n)/2;var l=Math.round((c.clientX-a.left-f)*s),_=Math.round((c.clientY-a.top)*s)}return l<0||l>=r.naturalWidth||_<0||_>=r.naturalHeight?null:[l,_]};var $=e.from_html("<!> <!> <!>",1),ee=e.from_html('<div class="image-container svelte-12vrxzd"><!> <button class="svelte-12vrxzd"><div><!></div></button></div>'),te=e.from_html("<!> <!>",1);function re(c,r){e.push(r,!1);let a=e.prop(r,"value",12),i=e.prop(r,"label",12,void 0),s=e.prop(r,"show_label",12),l=e.prop(r,"buttons",12,null),_=e.prop(r,"selectable",12,!1),n=e.prop(r,"i18n",12),f=e.prop(r,"display_icon_button_wrapper_top_corner",12,!1),h=e.prop(r,"fullscreen",12,!1),b=e.prop(r,"show_button_background",12,!0);const M=R(),q=t=>{let d=Z(t);d&&M("select",{index:d,value:null})};let w=e.mutable_source();var D={get value(){return a()},set value(t){a(t),e.flush()},get label(){return i()},set label(t){i(t),e.flush()},get show_label(){return s()},set show_label(t){s(t),e.flush()},get buttons(){return l()},set buttons(t){l(t),e.flush()},get selectable(){return _()},set selectable(t){_(t),e.flush()},get i18n(){return n()},set i18n(t){n(t),e.flush()},get display_icon_button_wrapper_top_corner(){return f()},set display_icon_button_wrapper_top_corner(t){f(t),e.flush()},get fullscreen(){return h()},set fullscreen(t){h(t),e.flush()},get show_button_background(){return b()},set show_button_background(t){b(t),e.flush()}};e.init();var k=te(),y=e.first_child(k);{let t=e.derived_safe_equal(()=>(e.deep_read_state(s()),e.deep_read_state(i()),e.deep_read_state(n()),e.untrack(()=>s()?i()||n()("image.image"):"")));Y(y,{get show_label(){return s()},get Icon(){return B},get label(){return e.get(t)}})}var E=e.sibling(y,2);{var H=t=>{C(t,{unpadded_box:!0,size:"large",children:(d,p)=>{B(d)},$$slots:{default:!0}})},N=t=>{var d=ee(),p=e.child(d);A(p,{get display_top_corner(){return f()},get show_background(){return b()},children:(g,ae)=>{var x=$(),P=e.first_child(x);{var W=o=>{U(o,{get fullscreen(){return h()},$$events:{fullscreen(u){e.bubble_event.call(this,r,u)}}})};e.if(P,o=>{e.deep_read_state(l()),e.untrack(()=>l()===null?!0:l().includes("fullscreen"))&&o(W)})}var S=e.sibling(P,2);{var j=o=>{{let u=e.derived_safe_equal(()=>(e.deep_read_state(a()),e.untrack(()=>a().orig_name||"image")));G(o,{get href(){return e.deep_read_state(a()),e.untrack(()=>a().url)},get download(){return e.get(u)},children:(z,le)=>{{let O=e.derived_safe_equal(()=>(e.deep_read_state(n()),e.untrack(()=>n()("common.download"))));J(z,{get Icon(){return K},get label(){return e.get(O)}})}},$$slots:{default:!0}})}};e.if(S,o=>{e.deep_read_state(l()),e.untrack(()=>l()===null?!0:l().includes("download"))&&o(j)})}var F=e.sibling(S,2);{var L=o=>{Q(o,{get i18n(){return n()},formatter:async u=>u?`<img src="${await X(u)}" />`:"",get value(){return a()},$$events:{share(u){e.bubble_event.call(this,r,u)},error(u){e.bubble_event.call(this,r,u)}}})};e.if(F,o=>{e.deep_read_state(l()),e.untrack(()=>l()===null?!0:l().includes("share"))&&o(L)})}e.append(g,x)},$$slots:{default:!0}});var v=e.sibling(p,2),m=e.child(v);let I;var T=e.child(m);V(T,{get src(){return e.deep_read_state(a()),e.untrack(()=>a().url)},restProps:{loading:"lazy",alt:""},$$events:{load(g){e.bubble_event.call(this,r,g)}}}),e.reset(m),e.reset(v),e.reset(d),e.bind_this(d,g=>e.set(w,g),()=>e.get(w)),e.template_effect(()=>I=e.set_class(m,1,"image-frame svelte-12vrxzd",null,I,{selectable:_()})),e.event("click",v,q),e.append(t,d)};e.if(E,t=>{e.deep_read_state(a()),e.untrack(()=>a()==null||!a()?.url)?t(H):t(N,!1)})}return e.append(c,k),e.pop(D)}const ge=Object.freeze(Object.defineProperty({__proto__:null,default:re},Symbol.toStringTag,{value:"Module"}));export{re as I,ge as a,Z as g};
