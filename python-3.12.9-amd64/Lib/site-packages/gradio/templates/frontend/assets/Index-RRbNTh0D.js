import"./svelte/svelte_internal_flags_async.js";import*as e from"./svelte/svelte_internal_client.js";import{B as D,b as H,d as P,E as J,c as K}from"./IconButtonWrapper-BWheMLkN.js";import"./svelte/svelte_internal_flags_legacy.js";import"./svelte/svelte_svelte.js";import"./i18n-DMKL1Q3B.js";import{G as N}from"./utils.svelte-Ceck75cM.js";import{F as O}from"./FullscreenButton-B8JPMBMa.js";import{S as Q}from"./StreamingBar-DrfQmzG9.js";import"./MarkdownCode-U4KoZ7qK.js";import"./index-BXZmp9-u.js";import"./svelte/svelte_animate.js";import"./svelte/svelte_attachments.js";import"./svelte/svelte_easing.js";import"./svelte/svelte_internal_flags_tracing.js";import"./svelte/svelte_internal_server.js";import"./svelte/svelte_legacy.js";import"./svelte/svelte_motion.js";import"./svelte/svelte_reactivity.js";import"./svelte/svelte_reactivity_window.js";import"./svelte/svelte_server.js";import"./svelte/svelte_store.js";import"./svelte/svelte_transition.js";import"./svelte/svelte_events.js";import"./prism-python-iiDAHIFD.js";var R=e.from_html("<img/>"),T=e.from_html('<button class="legend-item svelte-1oizopk"> </button>'),U=e.from_html('<div class="legend svelte-1oizopk"></div>'),V=e.from_html('<div class="image-container svelte-1oizopk"><!> <img alt="the base file that is annotated"/> <!></div> <!>',1),X=e.from_html('<!> <!> <div class="container svelte-1oizopk"><!></div>',1);function we(E,_){e.push(_,!0);const F=e.rest_props(_,["$$slots","$$events","$$legacy"]),t=new N(F);let h=e.state(e.proxy(t.props.value)),d=e.state(null),f,n=e.state(!1),G=e.derived(()=>t.shared.label||t.i18n("annotated_image.annotated_image"));e.user_effect(()=>{e.get(h)!=t.props.value&&(e.set(h,t.props.value,!0),t.dispatch("change"))});function b(s){e.set(d,s,!0)}function $(){e.set(d,null)}function M(s,k){t.dispatch("select",{value:k,index:s})}D(E,{get visible(){return t.shared.visible},get elem_id(){return t.shared.elem_id},get elem_classes(){return t.shared.elem_classes},padding:!1,get height(){return t.props.height},get width(){return t.props.width},allow_overflow:!1,get container(){return t.shared.container},get scale(){return t.shared.scale},get min_width(){return t.shared.min_width},get fullscreen(){return e.get(n)},set fullscreen(s){e.set(n,s,!0)},children:(s,k)=>{var w=X(),x=e.first_child(w);Q(x,e.spread_props({get autoscroll(){return t.shared.autoscroll},get i18n(){return t.i18n}},()=>t.shared.loading_status));var z=e.sibling(x,2);H(z,{get show_label(){return t.shared.show_label},get Icon(){return P},get label(){return e.get(G)}});var y=e.sibling(z,2),S=e.child(y);{var L=p=>{J(p,{size:"large",unpadded_box:!0,children:(c,m)=>{P(c)},$$slots:{default:!0}})},W=p=>{var c=V(),m=e.first_child(c),B=e.child(m);K(B,{children:(a,o)=>{var u=e.comment(),l=e.first_child(u);{var i=r=>{O(r,{get fullscreen(){return e.get(n)},$$events:{fullscreen:({detail:v})=>{e.set(n,v,!0)}}})};e.if(l,r=>{(t.props.buttons.includes("fullscreen")??!0)&&r(i)})}e.append(a,u)},$$slots:{default:!0}});var g=e.sibling(B,2);let I;var j=e.sibling(g,2);e.each(j,17,()=>t.props.value?t.props.value.annotations:[],e.index,(a,o,u)=>{var l=R();let i;e.template_effect(r=>{e.set_attribute(l,"alt",`segmentation mask identifying ${t.shared.label??""} within the uploaded file`),i=e.set_class(l,1,"mask fit-height svelte-1oizopk",null,i,{"fit-height":!e.get(n),active:e.get(d)==e.get(o).label,inactive:e.get(d)!=e.get(o).label&&e.get(d)!=null}),e.set_attribute(l,"src",e.get(o).image.url),e.set_style(l,r)},[()=>t.props.color_map&&e.get(o).label in t.props.color_map?null:`filter: hue-rotate(${Math.round(u*360/(t.props.value?.annotations.length??1))}deg);`]),e.append(a,l)}),e.reset(m),e.bind_this(m,a=>f=a,()=>f);var q=e.sibling(m,2);{var A=a=>{var o=U();e.each(o,21,()=>t.props.value.annotations,e.index,(u,l,i)=>{var r=T(),v=e.child(r,!0);e.reset(r),e.template_effect(C=>{e.set_style(r,`background-color: ${C??""}`),e.set_text(v,e.get(l).label)},[()=>t.props.color_map&&e.get(l).label in t.props.color_map?t.props.color_map[e.get(l).label]+"88":`hsla(${Math.round(i*360/t.props.value.annotations.length)}, 100%, 50%, 0.3)`]),e.event("mouseover",r,()=>b(e.get(l).label)),e.event("focus",r,()=>b(e.get(l).label)),e.event("mouseout",r,()=>$()),e.event("blur",r,()=>$()),e.event("click",r,()=>M(i,e.get(l).label)),e.append(u,r)}),e.reset(o),e.append(a,o)};e.if(q,a=>{t.props.show_legend&&t.props.value&&a(A)})}e.template_effect(()=>{I=e.set_class(g,1,"base-image svelte-1oizopk",null,I,{"fit-height":t.props.height&&!e.get(n)}),e.set_attribute(g,"src",t.props.value?t.props.value.image.url:null)}),e.append(p,c)};e.if(S,p=>{t.props.value==null?p(L):p(W,!1)})}e.reset(y),e.append(s,w)},$$slots:{default:!0}}),e.pop()}export{we as default};
