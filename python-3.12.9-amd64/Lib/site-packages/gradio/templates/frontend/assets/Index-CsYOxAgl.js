import"./svelte/svelte_internal_flags_async.js";import*as e from"./svelte/svelte_internal_client.js";import"./i18n-DMKL1Q3B.js";import{G as se}from"./utils.svelte-Ceck75cM.js";import{e as Z,R as Y,y as $,B as ae}from"./IconButtonWrapper-BWheMLkN.js";import"./svelte/svelte_internal_flags_legacy.js";import{createEventDispatcher as ne,tick as ie}from"./svelte/svelte_svelte.js";import{fly as oe}from"./svelte/svelte_transition.js";import{S as ue}from"./StreamingBar-DrfQmzG9.js";import{default as Xe}from"./Example-Ctdnw0MA.js";import"./svelte/svelte_store.js";import"./index-BXZmp9-u.js";import"./svelte/svelte_animate.js";import"./svelte/svelte_attachments.js";import"./svelte/svelte_easing.js";import"./svelte/svelte_internal_flags_tracing.js";import"./svelte/svelte_internal_server.js";import"./svelte/svelte_legacy.js";import"./svelte/svelte_motion.js";import"./svelte/svelte_reactivity.js";import"./svelte/svelte_reactivity_window.js";import"./svelte/svelte_server.js";import"./svelte/svelte_events.js";import"./MarkdownCode-U4KoZ7qK.js";import"./prism-python-iiDAHIFD.js";var de=e.from_html('<li data-testid="dropdown-option" role="option"><span>âœ“</span> </li>'),ce=e.from_html('<ul class="options svelte-1ou0lab" role="listbox"></ul>'),_e=e.from_html('<div class="reference"></div> <!>',1);function ee(x,l){e.push(l,!1);let t=e.prop(l,"choices",12),s=e.prop(l,"filtered_indices",12),u=e.prop(l,"show_options",12,!1),_=e.prop(l,"disabled",12,!1),f=e.prop(l,"selected_indices",28,()=>[]),A=e.prop(l,"active_index",12,null),O=e.prop(l,"remember_scroll",12,!1),D=e.prop(l,"offset_from_top",12,0),B=e.prop(l,"from_top",12,!1),w=e.mutable_source(),v=e.mutable_source(),p=e.mutable_source(),M=e.mutable_source(),o=e.mutable_source(),P=e.mutable_source(),G=e.mutable_source(),h=e.mutable_source(),y=e.mutable_source(),q=e.mutable_source(),L=e.mutable_source(0);function C(){const{top:a,bottom:d}=e.get(o).getBoundingClientRect();B()?e.set(w,D()):e.set(w,a),e.set(v,e.get(q)-d)}let m=null;function K(){u()&&(m!==null&&clearTimeout(m),m=setTimeout(()=>{C(),m=null},10))}function N(){e.get(P)?.scrollTo?.(0,e.get(L))}const Q=ne();e.legacy_pre_effect(()=>(e.deep_read_state(u()),e.get(o),e.deep_read_state(O()),e.get(P),e.deep_read_state(f()),e.get(p),e.get(v),e.get(w),e.deep_read_state(B())),()=>{if(u()&&e.get(o)){if(O())N();else if(e.get(P)&&f().length>0){let d=e.get(P).querySelectorAll("li");for(const z of Array.from(d))if(z.getAttribute("data-index")===f()[0].toString()){e.get(P)?.scrollTo?.(0,z.offsetTop);break}}C();const a=e.get(o).parentElement?.getBoundingClientRect();e.set(p,a?.height||0),e.set(M,a?.width||0)}e.get(v)>e.get(w)||B()?(e.set(G,`${e.get(w)}px`),e.set(y,e.get(v)),e.set(h,null)):(e.set(h,`${e.get(v)+e.get(p)}px`),e.set(y,e.get(w)-e.get(p)),e.set(G,null))}),e.legacy_pre_effect_reset();var V={get choices(){return t()},set choices(a){t(a),e.flush()},get filtered_indices(){return s()},set filtered_indices(a){s(a),e.flush()},get show_options(){return u()},set show_options(a){u(a),e.flush()},get disabled(){return _()},set disabled(a){_(a),e.flush()},get selected_indices(){return f()},set selected_indices(a){f(a),e.flush()},get active_index(){return A()},set active_index(a){A(a),e.flush()},get remember_scroll(){return O()},set remember_scroll(a){O(a),e.flush()},get offset_from_top(){return D()},set offset_from_top(a){D(a),e.flush()},get from_top(){return B()},set from_top(a){B(a),e.flush()}};e.init();var U=_e();e.event("scroll",e.window,K);var R=e.first_child(U);e.bind_this(R,a=>e.set(o,a),()=>e.get(o));var j=e.sibling(R,2);{var F=a=>{var d=ce();let z;e.each(d,5,s,e.index,(S,c)=>{var T=de();let r,i;var b=e.child(T);let n;var g=e.sibling(b);e.reset(T),e.template_effect((k,J,H)=>{r=e.set_class(T,1,"item svelte-1ou0lab",null,r,k),e.set_attribute(T,"data-index",e.get(c)),e.set_attribute(T,"aria-label",(e.deep_read_state(t()),e.get(c),e.untrack(()=>t()[e.get(c)][0]))),e.set_attribute(T,"aria-selected",J),i=e.set_style(T,"",i,{width:e.get(M)+"px"}),n=e.set_class(b,1,"inner-item svelte-1ou0lab",null,n,H),e.set_text(g,` ${e.deep_read_state(t()),e.get(c),e.untrack(()=>t()[e.get(c)][0])??""}`)},[()=>({selected:f().includes(e.get(c)),active:e.get(c)===A(),"bg-gray-100":e.get(c)===A(),"dark:bg-gray-600":e.get(c)===A()}),()=>(e.deep_read_state(f()),e.get(c),e.untrack(()=>f().includes(e.get(c)))),()=>({hide:!f().includes(e.get(c))})]),e.append(S,T)}),e.reset(d),e.bind_this(d,S=>e.set(P,S),()=>e.get(P)),e.template_effect(()=>z=e.set_style(d,"",z,{top:e.get(G),bottom:e.get(h),"max-height":`calc(${e.get(y)}px - var(--window-padding))`,width:e.get(M)+"px"})),e.transition(3,d,()=>oe,()=>({duration:200,y:5})),e.event("mousedown",d,e.preventDefault(S=>Q("change",S))),e.event("scroll",d,S=>e.set(L,S.currentTarget.scrollTop)),e.append(a,d)};e.if(j,a=>{u()&&!_()&&a(F)})}return e.bind_window_size("innerHeight",a=>e.set(q,a)),e.append(x,U),e.pop(V)}function pe(x,l){return(x%l+l)%l}function te(x,l){return x.reduce((t,s,u)=>((!l||s[0].toLowerCase().includes(l.toLowerCase()))&&t.push(u),t),[])}function re(x,l,t){if(x.key==="Escape")return[!1,l];if((x.key==="ArrowDown"||x.key==="ArrowUp")&&t.length>0)if(l===null)l=x.key==="ArrowDown"?t[0]:t[t.length-1];else{const s=t.indexOf(l),u=x.key==="ArrowUp"?-1:1;l=t[pe(s+u,t.length)]}return[!0,l]}var fe=e.from_html('<div class="token-remove svelte-1dv2vbb" role="button" tabindex="0"><!></div>'),ve=e.from_html('<div class="token svelte-1dv2vbb"><span class="svelte-1dv2vbb"><!></span> <!></div>'),ge=e.from_html('<div role="button" tabindex="0" class="token-remove remove-all svelte-1dv2vbb"><!></div>'),he=e.from_html('<!> <span class="icon-wrap svelte-1dv2vbb"><!></span>',1),me=e.from_html('<label><!> <div class="wrap svelte-1dv2vbb"><div><!> <div class="secondary-wrap svelte-1dv2vbb"><input autocomplete="off"/> <!></div></div> <!></div></label>');function be(x,l){e.push(l,!0),e.rest_props(l,["$$slots","$$events","$$legacy"]);const t=l.gradio;let s,u=e.state(""),_=e.derived(()=>t.shared.label||"Multiselect"),f=e.derived(()=>t.props.choices.map(r=>r[0])),A=e.derived(()=>t.props.choices.map(r=>r[1])),O=e.derived(()=>!t.shared.interactive),D=e.state(!1),B=e.derived(()=>{const r=te(t.props.choices,e.get(u));return[r,r.length>0&&!t.props.allow_custom_value?r[0]:null]}),w=e.derived(()=>e.to_array(e.get(B),2)),v=e.derived(()=>e.get(w)[0]),p=e.derived(()=>e.get(w)[1]);function M(){return t.props.value===void 0?[]:Array.isArray(t.props.value)?t.props.value.map(r=>{const i=e.get(A).indexOf(r);if(i!==-1)return i;if(t.props.allow_custom_value)return r}).filter(r=>r!==void 0):[]}let o=e.derived(M);function P(){t.props.allow_custom_value||e.set(u,""),t.props.allow_custom_value&&e.get(u)!==""&&(h(e.get(u)),e.set(u,"")),t.dispatch("blur"),e.set(D,!1),e.set(p,null)}function G(r){e.set(o,e.get(o).filter(i=>i!==r)),t.props.value=e.get(o).map(i=>typeof i=="number"?e.get(A)[i]:i),t.dispatch("input"),t.dispatch("select",{index:typeof r=="number"?r:-1,value:typeof r=="number"?e.get(A)[r]:r,selected:!1})}function h(r){(t.props.max_choices==null||e.get(o).length<t.props.max_choices)&&(e.get(o).push(r),t.dispatch("select",{index:typeof r=="number"?r:-1,value:typeof r=="number"?e.get(A)[r]:r,selected:!0})),e.get(o).length===t.props.max_choices&&(e.set(D,!1),e.set(p,null),s.blur()),t.props.value=e.get(o).map(i=>typeof i=="number"?e.get(A)[i]:i)}function y(r){const i=parseInt(r.detail.target.dataset.index);q(i)}function q(r){e.get(o).includes(r)?G(r):h(r),e.set(u,""),e.set(p,null),t.dispatch("input")}function L(r){e.set(o,[]),e.set(u,""),t.props.value=[],r.preventDefault()}function C(r){e.set(v,t.props.choices.map((i,b)=>b)),(t.props.max_choices===null||e.get(o).length<t.props.max_choices)&&e.set(D,!0),t.dispatch("focus"),e.set(D,!0)}function m(r){(i=>{var b=e.to_array(i,2);e.set(D,b[0],!0),e.set(p,b[1])})(re(r,e.get(p),e.get(v))),r.key==="Enter"&&(e.get(p)!==null?q(e.get(p)):t.props.allow_custom_value&&(h(e.get(u)),e.set(u,""))),r.key==="Backspace"&&e.get(u)===""&&e.set(o,[...e.get(o).slice(0,-1)]),e.get(o).length===t.props.max_choices&&(e.set(D,!1),e.set(p,null))}let K=e.state(e.proxy(t.props.value));e.user_effect(()=>{e.get(K)!==t.props.value&&(e.set(K,t.props.value,!0),t.dispatch("change"))});var N=me();let Q;var V=e.child(N);Z(V,{get show_label(){return t.shared.show_label},get info(){return t.props.info},children:(r,i)=>{e.next();var b=e.text();e.template_effect(()=>e.set_text(b,e.get(_))),e.append(r,b)},$$slots:{default:!0}});var U=e.sibling(V,2),R=e.child(U);let j;var F=e.child(R);e.each(F,17,()=>e.get(o),e.index,(r,i)=>{var b=ve(),n=e.child(b),g=e.child(n);{var k=E=>{var I=e.text();e.template_effect(()=>e.set_text(I,e.get(f)[e.get(i)])),e.append(E,I)},J=E=>{var I=e.text();e.template_effect(()=>e.set_text(I,e.get(i))),e.append(E,I)};e.if(g,E=>{typeof e.get(i)=="number"?E(k):E(J,!1)})}e.reset(n);var H=e.sibling(n,2);{var W=E=>{var I=fe(),le=e.child(I);Y(le),e.reset(I),e.template_effect(X=>e.set_attribute(I,"title",X),[()=>t.i18n("common.remove")+" "+e.get(i)]),e.event("click",I,e.preventDefault(()=>G(e.get(i)))),e.event("keydown",I,X=>{X.key==="Enter"&&G(e.get(i))}),e.append(E,I)};e.if(H,E=>{e.get(O)||E(W)})}e.reset(b),e.append(r,b)});var a=e.sibling(F,2),d=e.child(a);e.remove_input_defaults(d);let z;e.bind_this(d,r=>s=r,()=>s);var S=e.sibling(d,2);{var c=r=>{var i=he(),b=e.first_child(i);{var n=J=>{var H=ge(),W=e.child(H);Y(W),e.reset(H),e.template_effect(E=>e.set_attribute(H,"title",E),[()=>t.i18n("common.clear")]),e.event("click",H,L),e.event("keydown",H,E=>{E.key==="Enter"&&L(E)}),e.append(J,H)};e.if(b,J=>{e.get(o).length>0&&J(n)})}var g=e.sibling(b,2),k=e.child(g);$(k),e.reset(g),e.append(r,i)};e.if(S,r=>{e.get(O)||r(c)})}e.reset(a),e.reset(R);var T=e.sibling(R,2);ee(T,{get show_options(){return e.get(D)},get choices(){return t.props.choices},get filtered_indices(){return e.get(v)},get disabled(){return e.get(O)},get selected_indices(){return e.get(o)},get active_index(){return e.get(p)},remember_scroll:!0,$$events:{change:y}}),e.reset(U),e.reset(N),e.template_effect(r=>{Q=e.set_class(N,1,"svelte-1dv2vbb",null,Q,{container:t.shared.container}),j=e.set_class(R,1,"wrap-inner svelte-1dv2vbb",null,j,{show_options:e.get(D)}),z=e.set_class(d,1,"border-none svelte-1dv2vbb",null,z,r),d.disabled=e.get(O),d.readOnly=!t.props.filterable},[()=>({subdued:!e.get(f).includes(e.get(u))&&!t.props.allow_custom_value||e.get(o).length===t.props.max_choices})]),e.bind_value(d,()=>e.get(u),r=>e.set(u,r)),e.event("keydown",d,m),e.event("keyup",d,r=>{t.dispatch("key_up",{key:r.key,input_value:e.get(u)})}),e.event("blur",d,P),e.event("focus",d,C),e.append(x,N),e.pop()}var we=e.from_html('<div class="icon-wrap svelte-1xfsv4t"><!></div>'),ye=e.from_html('<div><!> <div class="wrap svelte-1xfsv4t"><div><div class="secondary-wrap svelte-1xfsv4t"><input role="listbox" aria-controls="dropdown-options" autocomplete="off"/> <!></div></div> <!></div></div>');function xe(x,l){e.push(l,!0);const t=typeof window<"u";let s=e.prop(l,"label",3,"Dropdown"),u=e.prop(l,"info",3,void 0),_=e.prop(l,"value",15),f=e.prop(l,"choices",19,()=>[]),A=e.prop(l,"interactive",3,!0),O=e.prop(l,"show_label",3,!0),D=e.prop(l,"container",3,!0),B=e.prop(l,"allow_custom_value",3,!1),w=e.prop(l,"filterable",3,!0),v,p=e.derived(()=>t&&v===document.activeElement),M=e.derived(()=>f().map(n=>n[0])),o=e.derived(()=>f().map(n=>n[1])),P=e.derived(()=>_()===void 0||_()===null||Array.isArray(_())&&_().length===0?["",null]:e.get(o).includes(_())?[e.get(M)[e.get(o).indexOf(_())],e.get(o).indexOf(_())]:B()?[_(),null]:["",null]),G=e.derived(()=>e.to_array(e.get(P),2)),h=e.derived(()=>e.get(G)[0]),y=e.derived(()=>e.get(G)[1]),q=e.state(!1),L=e.derived(()=>!A()),C=e.state(e.proxy(f().map((n,g)=>g))),m=e.state(null);function K(n){if(e.set(y,parseInt(n.detail.target.dataset.index)),isNaN(e.get(y))){e.set(y,null);return}let[g,k]=f()[e.get(y)];e.set(h,g),_(k),l.on_select?.({index:e.get(y),value:e.get(o)[e.get(y)],selected:!0}),e.set(p,!1),e.set(m,null),v.blur()}function N(n){e.set(C,f().map((g,k)=>k),!0),e.set(p,!0),l.on_focus?.()}function Q(){B()?_(e.get(h)):e.set(h,e.get(M)[e.get(o).indexOf(_())]),e.set(p,!1),e.set(m,null),e.set(C,f().map((n,g)=>g),!0),l.on_blur?.(),l.on_input?.()}async function V(n){await ie(),e.set(C,te(f(),e.get(h)),!0),e.set(m,e.get(C).length>0?e.get(C)[0]:null,!0),(g=>{var k=e.to_array(g,2);e.set(p,k[0]),e.set(m,k[1],!0)})(re(n,e.get(m),e.get(C))),n.key==="Enter"&&(e.get(m)!==null?(e.set(y,e.get(m)),_(e.get(o)[e.get(m)]),e.set(p,!1),v.blur(),e.set(m,null)):e.get(M).includes(e.get(h))?(e.set(y,e.get(M).indexOf(e.get(h))),_(e.get(o)[e.get(y)]),e.set(p,!1),e.set(m,null),v.blur()):B()&&(_(e.get(h)),e.set(y,null),e.set(p,!1),e.set(m,null),v.blur()))}let U=e.state(e.proxy(_()));e.user_effect(()=>{e.get(U)!==_()&&(e.set(U,_(),!0),l.on_change?.(_()))});var R=ye();let j;var F=e.child(R);Z(F,{get show_label(){return O()},get info(){return u()},children:(n,g)=>{e.next();var k=e.text();e.template_effect(()=>e.set_text(k,s())),e.append(n,k)},$$slots:{default:!0}});var a=e.sibling(F,2),d=e.child(a);let z;var S=e.child(d),c=e.child(S);e.remove_input_defaults(c);let T;e.bind_this(c,n=>v=n,()=>v);var r=e.sibling(c,2);{var i=n=>{var g=we(),k=e.child(g);$(k),e.reset(g),e.append(n,g)};e.if(r,n=>{e.get(L)||n(i)})}e.reset(S),e.reset(d);var b=e.sibling(d,2);{let n=e.derived(()=>e.get(y)===null?[]:[e.get(y)]);ee(b,{get show_options(){return e.get(p)},get choices(){return f()},get filtered_indices(){return e.get(C)},get disabled(){return e.get(L)},get selected_indices(){return e.get(n)},get active_index(){return e.get(m)},$$events:{change:K,load:()=>e.set(q,!0)}})}e.reset(a),e.reset(R),e.template_effect(n=>{j=e.set_class(R,1,"svelte-1xfsv4t",null,j,{container:D()}),z=e.set_class(d,1,"wrap-inner svelte-1xfsv4t",null,z,{show_options:e.get(p)}),e.set_attribute(c,"aria-expanded",e.get(p)),e.set_attribute(c,"aria-label",s()),T=e.set_class(c,1,"border-none svelte-1xfsv4t",null,T,n),c.disabled=e.get(L),c.readOnly=!w()},[()=>({subdued:!e.get(M).includes(e.get(h))&&!B()})]),e.bind_value(c,()=>e.get(h),n=>e.set(h,n)),e.event("keydown",c,V),e.event("keyup",c,n=>{l.on_key_up?.({key:n.key,input_value:e.get(h)})}),e.event("blur",c,Q),e.event("focus",c,N),e.append(x,R),e.pop()}var ke=e.from_html("<!> <!>",1);function Qe(x,l){e.push(l,!0);let t=e.rest_props(l,["$$slots","$$events","$$legacy"]);const s=new se(t);ae(x,{get visible(){return s.shared.visible},get elem_id(){return s.shared.elem_id},get elem_classes(){return s.shared.elem_classes},get padding(){return s.shared.container},allow_overflow:!1,get scale(){return s.shared.scale},get min_width(){return s.shared.min_width},children:(u,_)=>{var f=ke(),A=e.first_child(f);ue(A,e.spread_props({get autoscroll(){return s.shared.autoscroll},get i18n(){return s.i18n}},()=>s.shared.loading_status,{on_clear_status:()=>s.dispatch("clear_status",loading_status)}));var O=e.sibling(A,2);{var D=w=>{be(w,{get gradio(){return s}})},B=w=>{xe(w,{get label(){return s.shared.label},get info(){return s.props.info},get choices(){return s.props.choices},get interactive(){return s.shared.interactive},get show_label(){return s.shared.show_label},get container(){return s.shared.container},get allow_custom_value(){return s.props.allow_custom_value},get filterable(){return s.props.filterable},on_change:()=>s.dispatch("change"),on_input:()=>s.dispatch("input"),on_select:v=>s.dispatch("select",v),on_focus:()=>s.dispatch("focus"),on_blur:()=>s.dispatch("blur"),on_key_up:v=>s.dispatch("key_up",v),get value(){return s.props.value},set value(v){s.props.value=v}})};e.if(O,w=>{s.props.multiselect?w(D):w(B,!1)})}e.append(u,f)},$$slots:{default:!0}}),e.pop()}export{xe as BaseDropdown,ee as BaseDropdownOptions,Xe as BaseExample,be as BaseMultiselect,Qe as default};
