import"./svelte/svelte_internal_flags_async.js";import*as e from"./svelte/svelte_internal_client.js";import"./i18n-DMKL1Q3B.js";import{G as le}from"./utils.svelte-Ceck75cM.js";import{j as ne,b as Z,F as O,E as se,c as oe,I as Q,l as ie,m as ue,B as de,U as ge}from"./IconButtonWrapper-BWheMLkN.js";import"./svelte/svelte_internal_flags_legacy.js";import{createEventDispatcher as $,tick as ee}from"./svelte/svelte_svelte.js";import{U as V}from"./ModifyUpload-CMHuWP2V.js";import{S as _e}from"./StreamingBar-DrfQmzG9.js";import{default as Ze}from"./Example-C86RGnmZ.js";import"./svelte/svelte_store.js";import"./index-BXZmp9-u.js";import"./svelte/svelte_animate.js";import"./svelte/svelte_attachments.js";import"./svelte/svelte_easing.js";import"./svelte/svelte_internal_flags_tracing.js";import"./svelte/svelte_internal_server.js";import"./svelte/svelte_legacy.js";import"./svelte/svelte_motion.js";import"./svelte/svelte_reactivity.js";import"./svelte/svelte_reactivity_window.js";import"./svelte/svelte_server.js";import"./svelte/svelte_transition.js";import"./svelte/svelte_events.js";import"./MarkdownCode-U4KoZ7qK.js";import"./prism-python-iiDAHIFD.js";const X=b=>{let l=["B","KB","MB","GB","PB"],a=0;for(;b>1024;)b/=1024,a++;let p=l[a];return b.toFixed(1)+"&nbsp;"+p};var ce=e.from_html('<span class="drag-handle svelte-al0bnp">⋮⋮</span>'),pe=e.from_html("<!>&nbsp;&#8675;",1),he=e.from_html('<td class="svelte-al0bnp"><button class="label-clear-button svelte-al0bnp" aria-label="Remove this file">×</button></td>'),fe=e.from_html('<tr><td class="filename svelte-al0bnp"><!> <span class="stem svelte-al0bnp"> </span> <span class="ext svelte-al0bnp"> </span></td><td class="download svelte-al0bnp"><!></td><!></tr>'),ve=e.from_html('<div class="file-preview-holder svelte-al0bnp"><table class="file-preview svelte-al0bnp"><tbody class="svelte-al0bnp"></tbody></table></div>');function te(b,l){e.push(l,!1);const a=e.mutable_source(),p=$();let g=e.prop(l,"value",12),f=e.prop(l,"selectable",12,!1),r=e.prop(l,"height",12,void 0),_=e.prop(l,"i18n",12),d=e.prop(l,"allow_reordering",12,!1),h=e.mutable_source(null),c=e.mutable_source(null);function I(n,s){e.set(h,s),n.dataTransfer&&(n.dataTransfer.effectAllowed="move",n.dataTransfer.setData("text/plain",s.toString()))}function k(n,s){if(n.preventDefault(),s===e.get(a).length-1){const t=n.currentTarget.getBoundingClientRect(),o=t.top+t.height/2;e.set(c,n.clientY>o?e.get(a).length:s)}else e.set(c,s);n.dataTransfer&&(n.dataTransfer.dropEffect="move")}function A(n){(!n.dataTransfer?.dropEffect||n.dataTransfer.dropEffect==="none")&&(e.set(h,null),e.set(c,null))}function w(n,s){if(n.preventDefault(),e.get(h)===null||e.get(h)===s)return;const t=Array.isArray(g())?[...g()]:[g()],[o]=t.splice(e.get(h),1);t.splice(e.get(c)===e.get(a).length?e.get(a).length:s,0,o);const T=Array.isArray(g())?t:t[0];p("change",T),e.set(h,null),e.set(c,null)}function U(n){const s=n.lastIndexOf(".");return s===-1?[n,""]:[n.slice(0,s),n.slice(s)]}function y(n,s){const t=n.currentTarget;(n.target===t||t&&t.firstElementChild&&n.composedPath().includes(t.firstElementChild))&&p("select",{value:e.get(a)[s].orig_name,index:s})}function v(n){const s=e.get(a).splice(n,1);e.set(a,[...e.get(a)]),g(e.get(a)),p("delete",s[0]),p("change",e.get(a))}function i(n){p("download",n)}const B=typeof window<"u";e.legacy_pre_effect(()=>e.deep_read_state(g()),()=>{e.set(a,(Array.isArray(g())?g():[g()]).map(n=>{const[s,t]=U(n.orig_name??"");return{...n,filename_stem:s,filename_ext:t}}))}),e.legacy_pre_effect_reset();var E={get value(){return g()},set value(n){g(n),e.flush()},get selectable(){return f()},set selectable(n){f(n),e.flush()},get height(){return r()},set height(n){r(n),e.flush()},get i18n(){return _()},set i18n(n){_(n),e.flush()},get allow_reordering(){return d()},set allow_reordering(n){d(n),e.flush()}};e.init();var D=ve();let G;var S=e.child(D),R=e.child(S);return e.each(R,7,()=>e.get(a),n=>n.url,(n,s,t)=>{var o=fe();let T;var z=e.child(o),m=e.child(z);{var W=u=>{var x=ce();e.append(u,x)};e.if(m,u=>{e.deep_read_state(d()),e.get(a),e.untrack(()=>d()&&e.get(a).length>1)&&u(W)})}var q=e.sibling(m,2),Y=e.child(q,!0);e.reset(q);var j=e.sibling(q,2),K=e.child(j,!0);e.reset(j),e.reset(z);var F=e.sibling(z),L=e.child(F);{var M=u=>{{let x=e.derived_safe_equal(()=>(e.get(s),e.untrack(()=>B&&window.__is_colab__?null:e.get(s).orig_name)));ne(u,{get href(){return e.get(s),e.untrack(()=>e.get(s).url)},get download(){return e.get(x)},$$events:{click:()=>i(e.get(s))},children:(C,J)=>{var N=pe(),ae=e.first_child(N);e.html(ae,()=>(e.get(s),e.deep_read_state(X),e.untrack(()=>e.get(s).size!=null?X(e.get(s).size):"(size unknown)"))),e.next(),e.append(C,N)},$$slots:{default:!0}})}},H=u=>{var x=e.text();e.template_effect(C=>e.set_text(x,C),[()=>(e.deep_read_state(_()),e.untrack(()=>_()("file.uploading")))]),e.append(u,x)};e.if(L,u=>{e.get(s),e.untrack(()=>e.get(s).url)?u(M):u(H,!1)})}e.reset(F);var P=e.sibling(F);{var re=u=>{var x=he(),C=e.child(x);e.reset(x),e.event("click",C,()=>{v(e.get(t))}),e.event("keydown",C,J=>{J.key==="Enter"&&v(e.get(t))}),e.append(u,x)};e.if(P,u=>{e.get(a),e.untrack(()=>e.get(a).length>1)&&u(re)})}e.reset(o),e.template_effect(()=>{T=e.set_class(o,1,"file svelte-al0bnp",null,T,{selectable:f(),dragging:e.get(h)===e.get(t),"drop-target":e.get(c)===e.get(t)||e.get(t)===e.get(a).length-1&&e.get(c)===e.get(a).length}),e.set_attribute(o,"data-drop-target",(e.get(c),e.get(a),e.deep_read_state(e.get(t)),e.untrack(()=>e.get(c)===e.get(a).length&&e.get(t)===e.get(a).length-1||e.get(c)===e.get(t)+1?"after":"before"))),e.set_attribute(o,"draggable",(e.deep_read_state(d()),e.get(a),e.untrack(()=>d()&&e.get(a).length>1))),e.set_attribute(z,"aria-label",(e.get(s),e.untrack(()=>e.get(s).orig_name))),e.set_text(Y,(e.get(s),e.untrack(()=>e.get(s).filename_stem))),e.set_text(K,(e.get(s),e.untrack(()=>e.get(s).filename_ext)))}),e.event("click",o,u=>{y(u,e.get(t))}),e.event("dragstart",o,u=>I(u,e.get(t))),e.event("dragenter",o,e.preventDefault(function(u){e.bubble_event.call(this,l,u)})),e.event("dragover",o,u=>k(u,e.get(t))),e.event("drop",o,u=>w(u,e.get(t))),e.event("dragend",o,A),e.append(n,o)}),e.reset(R),e.reset(S),e.reset(D),e.template_effect(()=>G=e.set_style(D,"",G,{"max-height":r()?typeof r()=="number"?r()+"px":r():"auto"})),e.append(b,D),e.pop(E)}var me=e.from_html("<!> <!>",1);function be(b,l){e.push(l,!0);var a=me(),p=e.first_child(a);{let _=e.derived(()=>l.value===null),d=e.derived(()=>l.label||"File");Z(p,{get show_label(){return l.show_label},get float(){return e.get(_)},get Icon(){return O},get label(){return e.get(d)}})}var g=e.sibling(p,2);{var f=_=>{te(_,{get i18n(){return l.i18n},get selectable(){return l.selectable},get value(){return l.value},get height(){return l.height},$$events:{select(...d){l.on_select?.apply(this,d)},download(...d){l.on_download?.apply(this,d)}}})},r=_=>{se(_,{unpadded_box:!0,size:"large",children:(d,h)=>{O(d)},$$slots:{default:!0}})};e.if(g,_=>{l.value&&(!Array.isArray(l.value)||l.value.length>0)?_(f):_(r,!1)})}e.append(b,a),e.pop()}var we=e.from_html("<!> <!>",1),ye=e.from_html("<!> <!>",1),xe=e.from_html("<!> <!>",1);function ke(b,l){e.push(l,!1);let a=e.prop(l,"value",12),p=e.prop(l,"label",12),g=e.prop(l,"show_label",12,!0),f=e.prop(l,"file_count",12,"single"),r=e.prop(l,"file_types",12,null),_=e.prop(l,"selectable",12,!1),d=e.prop(l,"root",12),h=e.prop(l,"height",12,void 0),c=e.prop(l,"i18n",12),I=e.prop(l,"max_file_size",12,null),k=e.prop(l,"upload",12),A=e.prop(l,"stream_handler",12),w=e.prop(l,"uploading",12,!1),U=e.prop(l,"allow_reordering",12,!1),y=e.prop(l,"upload_promise",12,null);async function v({detail:t}){Array.isArray(a())?a([...a(),...Array.isArray(t)?t:[t]]):a()?a([a(),...Array.isArray(t)?t:[t]]):a(t),await ee(),B("change",a()),B("upload",t)}function i(){a(null),B("change",null),B("clear")}const B=$();let E=e.mutable_source(!1);e.legacy_pre_effect(()=>e.get(E),()=>{B("drag",e.get(E))}),e.legacy_pre_effect_reset();var D={get value(){return a()},set value(t){a(t),e.flush()},get label(){return p()},set label(t){p(t),e.flush()},get show_label(){return g()},set show_label(t){g(t),e.flush()},get file_count(){return f()},set file_count(t){f(t),e.flush()},get file_types(){return r()},set file_types(t){r(t),e.flush()},get selectable(){return _()},set selectable(t){_(t),e.flush()},get root(){return d()},set root(t){d(t),e.flush()},get height(){return h()},set height(t){h(t),e.flush()},get i18n(){return c()},set i18n(t){c(t),e.flush()},get max_file_size(){return I()},set max_file_size(t){I(t),e.flush()},get upload(){return k()},set upload(t){k(t),e.flush()},get stream_handler(){return A()},set stream_handler(t){A(t),e.flush()},get uploading(){return w()},set uploading(t){w(t),e.flush()},get allow_reordering(){return U()},set allow_reordering(t){U(t),e.flush()},get upload_promise(){return y()},set upload_promise(t){y(t),e.flush()}};e.init();var G=xe(),S=e.first_child(G);{let t=e.derived_safe_equal(()=>!a()),o=e.derived_safe_equal(()=>p()||"File");Z(S,{get show_label(){return g()},get Icon(){return O},get float(){return e.get(t)},get label(){return e.get(o)}})}var R=e.sibling(S,2);{var n=t=>{var o=ye(),T=e.first_child(o);oe(T,{children:(m,W)=>{var q=we(),Y=e.first_child(q);{var j=F=>{{let L=e.derived_safe_equal(()=>(e.deep_read_state(c()),e.untrack(()=>c()("common.upload"))));Q(F,{get Icon(){return ue},get label(){return e.get(L)},children:(M,H)=>{V(M,{icon_upload:!0,get filetype(){return r()},get file_count(){return f()},get max_file_size(){return I()},get root(){return d()},get stream_handler(){return A()},get upload(){return k()},get upload_promise(){return y()},set upload_promise(P){y(P)},get dragging(){return e.get(E)},set dragging(P){e.set(E,P)},get uploading(){return w()},set uploading(P){w(P)},$$events:{load:v,error(P){e.bubble_event.call(this,l,P)}},$$legacy:!0})},$$slots:{default:!0}})}};e.if(Y,F=>{e.deep_read_state(f()),e.deep_read_state(a()),e.untrack(()=>!(f()==="single"&&(Array.isArray(a())?a().length>0:a()!==null)))&&F(j)})}var K=e.sibling(Y,2);{let F=e.derived_safe_equal(()=>(e.deep_read_state(c()),e.untrack(()=>c()("common.clear"))));Q(K,{get Icon(){return ie},get label(){return e.get(F)},$$events:{click:L=>{B("clear"),L.stopPropagation(),i()}}})}e.append(m,q)},$$slots:{default:!0}});var z=e.sibling(T,2);te(z,{get i18n(){return c()},get selectable(){return _()},get value(){return a()},get height(){return h()},get allow_reordering(){return U()},$$events:{select(m){e.bubble_event.call(this,l,m)},change(m){e.bubble_event.call(this,l,m)},delete(m){e.bubble_event.call(this,l,m)}}}),e.append(t,o)},s=t=>{V(t,{get filetype(){return r()},get file_count(){return f()},get max_file_size(){return I()},get root(){return d()},get stream_handler(){return A()},get upload(){return k()},get height(){return h()},get upload_promise(){return y()},set upload_promise(o){y(o)},get dragging(){return e.get(E)},set dragging(o){e.set(E,o)},get uploading(){return w()},set uploading(o){w(o)},$$events:{load:v,error(o){e.bubble_event.call(this,l,o)}},children:(o,T)=>{var z=e.comment(),m=e.first_child(z);e.slot(m,l,"default",{},null),e.append(o,z)},$$slots:{default:!0},$$legacy:!0})};e.if(R,t=>{e.deep_read_state(a()),e.untrack(()=>a()&&(Array.isArray(a())?a().length>0:!0))?t(n):t(s,!1)})}return e.append(b,G),e.pop(D)}var Ae=e.from_html("<!> <!>",1);function Qe(b,l){e.push(l,!0);const a=e.rest_props(l,["$$slots","$$events","$$legacy"]);let p=e.state(void 0),g=e.state(!1);class f extends le{async get_data(){return e.get(p)&&(await e.get(p),await ee()),await super.get_data()}}const r=new f(a);let _=e.state(e.proxy(r.props.value));e.user_effect(()=>{e.get(_)!==r.props.value&&(e.set(_,r.props.value,!0),r.dispatch("change",e.snapshot(r.props.value)))});{let d=e.derived(()=>r.props.value?"solid":"dashed"),h=e.derived(()=>e.get(g)?"focus":"base");de(b,{get visible(){return r.shared.visible},get variant(){return e.get(d)},get border_mode(){return e.get(h)},padding:!1,get elem_id(){return r.shared.elem_id},get elem_classes(){return r.shared.elem_classes},get container(){return r.shared.container},get scale(){return r.shared.scale},get min_width(){return r.shared.min_width},allow_overflow:!1,children:(c,I)=>{var k=Ae(),A=e.first_child(k);{let v=e.derived(()=>r.shared.loading_status?.status||"complete");_e(A,e.spread_props({get autoscroll(){return r.shared.autoscroll},get i18n(){return r.i18n}},()=>r.shared.loading_status,{get status(){return e.get(v)},on_clear_status:()=>r.dispatch("clear_status",r.shared.loading_status)}))}var w=e.sibling(A,2);{var U=v=>{be(v,{on_select:({detail:i})=>r.dispatch("select",i),on_download:({detail:i})=>r.dispatch("download",i),get selectable(){return r.props._selectable},get value(){return r.props.value},get label(){return r.shared.label},get show_label(){return r.shared.show_label},get height(){return r.props.height},get i18n(){return r.i18n}})},y=v=>{ke(v,{upload:(...i)=>r.shared.client.upload(...i),stream_handler:(...i)=>r.shared.client.stream(...i),get label(){return r.shared.label},get show_label(){return r.shared.show_label},get value(){return r.props.value},get file_count(){return r.props.file_count},get file_types(){return r.props.file_types},get selectable(){return r.props._selectable},get height(){return r.props.height},get root(){return r.shared.root},get allow_reordering(){return r.props.allow_reordering},get max_file_size(){return r.shared.max_file_size},get i18n(){return r.i18n},get upload_promise(){return e.get(p)},set upload_promise(i){e.set(p,i,!0)},$$events:{change:({detail:i})=>{r.props.value=i},drag:({detail:i})=>e.set(g,i,!0),clear:()=>r.dispatch("clear"),select:({detail:i})=>r.dispatch("select",i),upload:()=>r.dispatch("upload"),error:({detail:i})=>{r.shared.loading_status=r.shared.loading_status||{},r.shared.loading_status.status="error",r.dispatch("error",i)},delete:({detail:i})=>{r.dispatch("delete",i)}},children:(i,B)=>{ge(i,{get i18n(){return r.i18n},type:"file"})},$$slots:{default:!0}})};e.if(w,v=>{r.shared.interactive?v(y,!1):v(U)})}e.append(c,k)},$$slots:{default:!0}})}e.pop()}export{Ze as BaseExample,be as BaseFile,ke as BaseFileUpload,te as FilePreview,Qe as default};
