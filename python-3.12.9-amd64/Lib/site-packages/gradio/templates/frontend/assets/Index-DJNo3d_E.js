import"./svelte/svelte_internal_flags_async.js";import*as e from"./svelte/svelte_internal_client.js";import{onMount as fe,createEventDispatcher as ce,tick as pe}from"./svelte/svelte_svelte.js";import"./i18n-DMKL1Q3B.js";import{G as Se}from"./utils.svelte-Ceck75cM.js";import"./svelte/svelte_internal_flags_legacy.js";import{s as ae}from"./select-BigU4G0v.js";import{d as Ie}from"./dispatch-kxCwF96_.js";import{b as xe,d as ue,E as ze,c as Le,I as ie,f as Pe,j as Ye,D as Xe,l as ke,B as ve,U as Be}from"./IconButtonWrapper-BWheMLkN.js";import{F as $e}from"./FullscreenButton-B8JPMBMa.js";import"./index-BXZmp9-u.js";import{tweened as Ce}from"./svelte/svelte_motion.js";import{U as be}from"./ModifyUpload-CMHuWP2V.js";import{S as we}from"./StreamingBar-DrfQmzG9.js";import"./svelte/svelte_store.js";import"./MarkdownCode-U4KoZ7qK.js";import"./prism-python-iiDAHIFD.js";import"./svelte/svelte_animate.js";import"./svelte/svelte_attachments.js";import"./svelte/svelte_easing.js";import"./svelte/svelte_internal_flags_tracing.js";import"./svelte/svelte_internal_server.js";import"./svelte/svelte_legacy.js";import"./svelte/svelte_reactivity.js";import"./svelte/svelte_reactivity_window.js";import"./svelte/svelte_server.js";import"./svelte/svelte_transition.js";import"./svelte/svelte_events.js";function qe(c){let t;for(;t=c.sourceEvent;)c=t;return c}function ye(c,t){if(c=qe(c),t===void 0&&(t=c.currentTarget),t){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var a=r.createSVGPoint();return a.x=c.clientX,a.y=c.clientY,a=a.matrixTransform(t.getScreenCTM().inverse()),[a.x,a.y]}if(t.getBoundingClientRect){var n=t.getBoundingClientRect();return[c.clientX-n.left-t.clientLeft,c.clientY-n.top-t.clientTop]}}return[c.pageX,c.pageY]}const Ue={passive:!1},le={capture:!0,passive:!1};function ge(c){c.stopImmediatePropagation()}function re(c){c.preventDefault(),c.stopImmediatePropagation()}function We(c){var t=c.document.documentElement,r=ae(c).on("dragstart.drag",re,le);"onselectstart"in t?r.on("selectstart.drag",re,le):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function je(c,t){var r=c.document.documentElement,a=ae(c).on("dragstart.drag",null);t&&(a.on("click.drag",re,le),setTimeout(function(){a.on("click.drag",null)},0)),"onselectstart"in r?a.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const oe=c=>()=>c;function _e(c,{sourceEvent:t,subject:r,target:a,identifier:n,active:s,x:d,y:o,dx:_,dy:Y,dispatch:x}){Object.defineProperties(this,{type:{value:c,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:a,enumerable:!0,configurable:!0},identifier:{value:n,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:d,enumerable:!0,configurable:!0},y:{value:o,enumerable:!0,configurable:!0},dx:{value:_,enumerable:!0,configurable:!0},dy:{value:Y,enumerable:!0,configurable:!0},_:{value:x}})}_e.prototype.on=function(){var c=this._.on.apply(this._,arguments);return c===this._?this:c};function Fe(c){return!c.ctrlKey&&!c.button}function Oe(){return this.parentNode}function Ge(c,t){return t??{x:c.x,y:c.y}}function Ae(){return navigator.maxTouchPoints||"ontouchstart"in this}function He(){var c=Fe,t=Oe,r=Ge,a=Ae,n={},s=Ie("start","drag","end"),d=0,o,_,Y,x,z=0;function m(i){i.on("mousedown.drag",T).filter(a).on("touchstart.drag",h).on("touchmove.drag",v,Ue).on("touchend.drag touchcancel.drag",X).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function T(i,b){if(!(x||!c.call(this,i,b))){var y=$(this,t.call(this,i,b),i,b,"mouse");y&&(ae(i.view).on("mousemove.drag",I,le).on("mouseup.drag",l,le),We(i.view),ge(i),Y=!1,o=i.clientX,_=i.clientY,y("start",i))}}function I(i){if(re(i),!Y){var b=i.clientX-o,y=i.clientY-_;Y=b*b+y*y>z}n.mouse("drag",i)}function l(i){ae(i.view).on("mousemove.drag mouseup.drag",null),je(i.view,Y),re(i),n.mouse("end",i)}function h(i,b){if(c.call(this,i,b)){var y=i.changedTouches,w=t.call(this,i,b),k=y.length,D,R;for(D=0;D<k;++D)(R=$(this,w,i,b,y[D].identifier,y[D]))&&(ge(i),R("start",i,y[D]))}}function v(i){var b=i.changedTouches,y=b.length,w,k;for(w=0;w<y;++w)(k=n[b[w].identifier])&&(re(i),k("drag",i,b[w]))}function X(i){var b=i.changedTouches,y=b.length,w,k;for(x&&clearTimeout(x),x=setTimeout(function(){x=null},500),w=0;w<y;++w)(k=n[b[w].identifier])&&(ge(i),k("end",i,b[w]))}function $(i,b,y,w,k,D){var R=s.copy(),p=ye(D||y,b),F,q,C;if((C=r.call(i,new _e("beforestart",{sourceEvent:y,target:m,identifier:k,active:d,x:p[0],y:p[1],dx:0,dy:0,dispatch:R}),w))!=null)return F=C.x-p[0]||0,q=C.y-p[1]||0,function J(f,u,S){var G=p,j;switch(f){case"start":n[k]=J,j=d++;break;case"end":delete n[k],--d;case"drag":p=ye(S||u,b),j=d;break}R.call(f,i,new _e(f,{sourceEvent:u,subject:C,target:m,identifier:k,active:j,x:p[0]+F,y:p[1]+q,dx:p[0]-G[0],dy:p[1]-G[1],dispatch:R}),w)}}return m.filter=function(i){return arguments.length?(c=typeof i=="function"?i:oe(!!i),m):c},m.container=function(i){return arguments.length?(t=typeof i=="function"?i:oe(i),m):t},m.subject=function(i){return arguments.length?(r=typeof i=="function"?i:oe(i),m):r},m.touchable=function(i){return arguments.length?(a=typeof i=="function"?i:oe(!!i),m):a},m.on=function(){var i=s.on.apply(s,arguments);return i===s?m:i},m.clickDistance=function(i){return arguments.length?(z=(i=+i)*i,m):Math.sqrt(z)},m}var Ne=e.from_html('<div class="wrap svelte-b2bl92" role="none"><div class="content svelte-b2bl92"><!></div> <div role="none"><span><span class="icon left svelte-b2bl92">◢</span><span class="icon center svelte-b2bl92"></span><span class="icon right svelte-b2bl92">◢</span></span> <div class="inner svelte-b2bl92"></div></div></div>');function Me(c,t){e.push(t,!1);function r(f,u,S){return Math.min(Math.max(f,u),S)}let a=e.prop(t,"position",12,.5),n=e.prop(t,"disabled",12,!1),s=e.prop(t,"slider_color",12,"var(--border-color-primary)"),d=e.prop(t,"image_size",28,()=>({top:0,left:0,width:0,height:0})),o=e.prop(t,"el",12,void 0),_=e.prop(t,"parent_el",12,void 0),Y=e.mutable_source(),x=e.mutable_source(0),z=e.mutable_source(!1),m=0;function T(f){m=_()?.getBoundingClientRect().width||0,f===0&&d(d().width=o()?.getBoundingClientRect().width||0,!0),e.set(x,r(d().width*a()+d().left,0,m))}function I(f,u){const S=Math.pow(10,u);return Math.round((f+Number.EPSILON)*S)/S}function l(f){e.set(x,r(f,0,m)),a(I((f-d().left)/d().width,5))}function h(f){n()||(e.set(z,!0),l(f.x))}function v(f){n()||l(f.x)}function X(){n()||e.set(z,!1)}function $(f){e.set(x,r(d().width*f+d().left,0,m))}fe(()=>{T(d().width);const f=He().on("start",h).on("drag",v).on("end",X);ae(e.get(Y)).call(f)}),e.legacy_pre_effect(()=>e.deep_read_state(d()),()=>{T(d().width)}),e.legacy_pre_effect(()=>e.deep_read_state(a()),()=>{$(a())}),e.legacy_pre_effect_reset();var i={get position(){return a()},set position(f){a(f),e.flush()},get disabled(){return n()},set disabled(f){n(f),e.flush()},get slider_color(){return s()},set slider_color(f){s(f),e.flush()},get image_size(){return d()},set image_size(f){d(f),e.flush()},get el(){return o()},set el(f){o(f),e.flush()},get parent_el(){return _()},set parent_el(f){_(f),e.flush()}};e.init();var b=Ne();e.event("resize",e.window,()=>T(d().width));var y=e.child(b),w=e.child(y);e.slot(w,t,"default",{},null),e.reset(y),e.bind_this(y,f=>o(f),()=>o());var k=e.sibling(y,2);let D;var R=e.child(k);let p;var F=e.sibling(e.child(R));let q;e.next(),e.reset(R);var C=e.sibling(R,2);let J;return e.reset(k),e.bind_this(k,f=>e.set(Y,f),()=>e.get(Y)),e.reset(b),e.bind_this(b,f=>_(f),()=>_()),e.template_effect(()=>{D=e.set_class(k,1,"outer svelte-b2bl92",null,D,{disabled:n(),grab:e.get(z)}),e.set_style(k,`transform: translateX(${e.get(x)??""}px)`),p=e.set_class(R,1,"icon-wrap svelte-b2bl92",null,p,{active:e.get(z),disabled:n()}),q=e.set_style(F,"",q,{"--color":s()}),J=e.set_style(C,"",J,{"--color":s()})}),e.append(c,b),e.pop(i)}var Ve=e.from_html("<img/>");function de(c,t){const r=e.legacy_rest_props(t,["children","$$slots","$$events","$$legacy"]),a=e.legacy_rest_props(r,["src","fullscreen","fixed","transform","img_el","hidden","variant","max_height"]);e.push(t,!1);let n=e.prop(t,"src",12,void 0),s=e.prop(t,"fullscreen",12,!1),d=e.prop(t,"fixed",12,!1),o=e.prop(t,"transform",12,"translate(0px, 0px) scale(1)"),_=e.prop(t,"img_el",12,null),Y=e.prop(t,"hidden",12,!1),x=e.prop(t,"variant",12,"upload"),z=e.prop(t,"max_height",12,500);const m=ce();function T(h){if(!h)return{top:0,left:0,width:0,height:0};const v=h.parentElement?.getBoundingClientRect();if(!v)return{top:0,left:0,width:0,height:0};const X=h.naturalWidth/h.naturalHeight,$=v.width/v.height;let i,b;X>$?(i=v.width,b=v.width/X):(b=v.height,i=v.height*X);const y=(v.width-i)/2;return{top:(v.height-b)/2,left:y,width:i,height:b}}fe(()=>{const h=new ResizeObserver(async v=>{for(const X of v)await pe(),m("load",T(_()))});return h.observe(_()),()=>{h.disconnect()}});var I={get src(){return n()},set src(h){n(h),e.flush()},get fullscreen(){return s()},set fullscreen(h){s(h),e.flush()},get fixed(){return d()},set fixed(h){d(h),e.flush()},get transform(){return o()},set transform(h){o(h),e.flush()},get img_el(){return _()},set img_el(h){_(h),e.flush()},get hidden(){return Y()},set hidden(h){Y(h),e.flush()},get variant(){return x()},set variant(h){x(h),e.flush()},get max_height(){return z()},set max_height(h){z(h),e.flush()}};e.init();var l=Ve();return e.attribute_effect(l,()=>({src:n(),...a,[e.CLASS]:{fixed:d(),hidden:Y(),preview:x()==="preview",slider:x()==="upload",fullscreen:s(),small:!s()},[e.STYLE]:{transform:o(),"max-height":z()&&!s()?`${z()}px`:null}}),void 0,void 0,void 0,"svelte-j3ek2n"),e.bind_this(l,h=>_(h),()=>_()),e.replay_events(l),e.event("load",l,()=>m("load",T(_()))),e.append(c,l),e.pop(I)}class Je{container;image;scale;offsetX;offsetY;isDragging;lastX;lastY;initial_left_padding;initial_top_padding;initial_width;initial_height;subscribers;handleImageLoad;real_image_size={top:0,left:0,width:0,height:0};last_touch_distance;constructor(t,r){this.container=t,this.image=r,this.scale=1,this.offsetX=0,this.offsetY=0,this.isDragging=!1,this.lastX=0,this.lastY=0,this.initial_left_padding=0,this.initial_top_padding=0,this.initial_width=0,this.initial_height=0,this.subscribers=[],this.last_touch_distance=0,this.handleWheel=this.handleWheel.bind(this),this.handleMouseDown=this.handleMouseDown.bind(this),this.handleMouseMove=this.handleMouseMove.bind(this),this.handleMouseUp=this.handleMouseUp.bind(this),this.handleImageLoad=this.init.bind(this),this.handleTouchStart=this.handleTouchStart.bind(this),this.handleTouchMove=this.handleTouchMove.bind(this),this.handleTouchEnd=this.handleTouchEnd.bind(this),this.image.addEventListener("load",this.handleImageLoad),this.container.addEventListener("wheel",this.handleWheel),this.container.addEventListener("mousedown",this.handleMouseDown),document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp),this.container.addEventListener("touchstart",this.handleTouchStart),document.addEventListener("touchmove",this.handleTouchMove),document.addEventListener("touchend",this.handleTouchEnd),new ResizeObserver(n=>{for(const s of n)s.target===this.container&&(this.handleResize(),this.get_image_size(this.image))}).observe(this.container)}handleResize(){this.init()}init(){const t=this.container.getBoundingClientRect(),r=this.image.getBoundingClientRect();this.initial_left_padding=r.left-t.left,this.initial_top_padding=r.top-t.top,this.initial_width=r.width,this.initial_height=r.height,this.reset_zoom(),this.updateTransform()}reset_zoom(){this.scale=1,this.offsetX=0,this.offsetY=0,this.updateTransform()}handleMouseDown(t){const r=this.image.getBoundingClientRect();if(t.clientX>=r.left&&t.clientX<=r.right&&t.clientY>=r.top&&t.clientY<=r.bottom){if(t.preventDefault(),this.scale===1)return;this.isDragging=!0,this.lastX=t.clientX,this.lastY=t.clientY,this.image.style.cursor="grabbing"}}handleMouseMove(t){if(!this.isDragging)return;const r=t.clientX-this.lastX,a=t.clientY-this.lastY;this.offsetX+=r,this.offsetY+=a,this.lastX=t.clientX,this.lastY=t.clientY,this.updateTransform(),this.updateTransform()}handleMouseUp(){this.isDragging&&(this.constrain_to_bounds(!0),this.updateTransform(),this.isDragging=!1,this.image.style.cursor=this.scale>1?"grab":"zoom-in")}async handleWheel(t){t.preventDefault();const r=this.container.getBoundingClientRect(),a=this.image.getBoundingClientRect();if(t.clientX<a.left||t.clientX>a.right||t.clientY<a.top||t.clientY>a.bottom)return;const n=1.05,s=this.scale,d=-Math.sign(t.deltaY)>0?Math.min(15,s*n):Math.max(1,s/n);if(d===s)return;const o=t.clientX-r.left-this.initial_left_padding,_=t.clientY-r.top-this.initial_top_padding;this.scale=d,this.offsetX=this.compute_new_offset({cursor_position:o,current_offset:this.offsetX,new_scale:d,old_scale:s}),this.offsetY=this.compute_new_offset({cursor_position:_,current_offset:this.offsetY,new_scale:d,old_scale:s}),this.updateTransform(),this.constrain_to_bounds(),this.updateTransform(),this.image.style.cursor=this.scale>1?"grab":"zoom-in"}compute_new_position({position:t,scale:r,anchor_position:a}){return t-(t-a)*(r/this.scale)}compute_new_offset({cursor_position:t,current_offset:r,new_scale:a,old_scale:n}){return t-a/n*(t-r)}constrain_to_bounds(t=!1){if(this.scale===1){this.offsetX=0,this.offsetY=0;return}const r={top:this.real_image_size.top*this.scale+this.offsetY,left:this.real_image_size.left*this.scale+this.offsetX,width:this.real_image_size.width*this.scale,height:this.real_image_size.height*this.scale,bottom:this.real_image_size.top*this.scale+this.offsetY+this.real_image_size.height*this.scale,right:this.real_image_size.left*this.scale+this.offsetX+this.real_image_size.width*this.scale},a=this.real_image_size.left+this.real_image_size.width,n=this.real_image_size.top+this.real_image_size.height;t&&(r.top>this.real_image_size.top?this.offsetY=this.calculate_position(this.real_image_size.top,0,"y"):r.bottom<n&&(this.offsetY=this.calculate_position(n,1,"y")),r.left>this.real_image_size.left?this.offsetX=this.calculate_position(this.real_image_size.left,0,"x"):r.right<a&&(this.offsetX=this.calculate_position(a,1,"x")))}updateTransform(){this.notify({x:this.offsetX,y:this.offsetY,scale:this.scale})}destroy(){this.container.removeEventListener("wheel",this.handleWheel),this.container.removeEventListener("mousedown",this.handleMouseDown),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),this.container.removeEventListener("touchstart",this.handleTouchStart),document.removeEventListener("touchmove",this.handleTouchMove),document.removeEventListener("touchend",this.handleTouchEnd),this.image.removeEventListener("load",this.handleImageLoad)}subscribe(t){this.subscribers.push(t)}unsubscribe(t){this.subscribers=this.subscribers.filter(r=>r!==t)}notify({x:t,y:r,scale:a}){this.subscribers.forEach(n=>n({x:t,y:r,scale:a}))}handleTouchStart(t){t.preventDefault();const r=this.image.getBoundingClientRect(),a=t.touches[0];if(a.clientX>=r.left&&a.clientX<=r.right&&a.clientY>=r.top&&a.clientY<=r.bottom){if(t.touches.length===1&&this.scale>1)this.isDragging=!0,this.lastX=a.clientX,this.lastY=a.clientY;else if(t.touches.length===2){const n=t.touches[0],s=t.touches[1];this.last_touch_distance=Math.hypot(s.clientX-n.clientX,s.clientY-n.clientY)}}}get_image_size(t){if(!t)return;const r=t.parentElement?.getBoundingClientRect();if(!r)return;const a=t.naturalWidth/t.naturalHeight,n=r.width/r.height;let s,d;a>n?(s=r.width,d=r.width/a):(d=r.height,s=r.height*a);const o=(r.width-s)/2,_=(r.height-d)/2;this.real_image_size={top:_,left:o,width:s,height:d}}handleTouchMove(t){if(t.touches.length===1&&this.isDragging){t.preventDefault();const r=t.touches[0],a=r.clientX-this.lastX,n=r.clientY-this.lastY;this.offsetX+=a,this.offsetY+=n,this.lastX=r.clientX,this.lastY=r.clientY,this.updateTransform()}else if(t.touches.length===2){t.preventDefault();const r=t.touches[0],a=t.touches[1],n=Math.hypot(a.clientX-r.clientX,a.clientY-r.clientY);if(this.last_touch_distance===0){this.last_touch_distance=n;return}const s=n/this.last_touch_distance,d=this.scale,o=Math.min(15,Math.max(1,d*s));if(o===d){this.last_touch_distance=n;return}const _=this.container.getBoundingClientRect(),Y=(r.clientX+a.clientX)/2-_.left-this.initial_left_padding,x=(r.clientY+a.clientY)/2-_.top-this.initial_top_padding;this.scale=o,this.offsetX=this.compute_new_offset({cursor_position:Y,current_offset:this.offsetX,new_scale:o,old_scale:d}),this.offsetY=this.compute_new_offset({cursor_position:x,current_offset:this.offsetY,new_scale:o,old_scale:d}),this.updateTransform(),this.constrain_to_bounds(),this.updateTransform(),this.last_touch_distance=n,this.image.style.cursor=this.scale>1?"grab":"zoom-in"}}handleTouchEnd(t){this.isDragging&&(this.constrain_to_bounds(!0),this.updateTransform(),this.isDragging=!1),t.touches.length===0&&(this.last_touch_distance=0)}calculate_position(t,r,a){if(this.container.getBoundingClientRect(),a==="x"){const n=t,s=this.real_image_size.left+r*this.real_image_size.width;return n-s*this.scale}if(a==="y"){const n=t,s=this.real_image_size.top+r*this.real_image_size.height;return n-s*this.scale}return 0}}var Ke=e.from_html("<!> <!> <!> <!>",1),Ze=e.from_html("<!> <!>",1),Qe=e.from_html('<div class="image-container svelte-1880bc6"><!> <div><!></div></div>'),et=e.from_html("<!> <!>",1);function tt(c,t){e.push(t,!1);const r=()=>e.store_get(D,"$transform",a),[a,n]=e.setup_stores(),s=e.mutable_source(),d=e.mutable_source();let o=e.prop(t,"value",28,()=>[null,null]),_=e.prop(t,"label",12,void 0),Y=e.prop(t,"show_download_button",12,!0),x=e.prop(t,"show_label",12),z=e.prop(t,"i18n",12),m=e.prop(t,"position",12),T=e.prop(t,"layer_images",12,!0),I=e.prop(t,"show_single",12,!1),l=e.prop(t,"slider_color",12),h=e.prop(t,"show_fullscreen_button",12,!0),v=e.prop(t,"fullscreen",12,!1),X=e.prop(t,"el_width",12,0),$=e.prop(t,"max_height",12),i=e.prop(t,"interactive",12,!0);const b=ce();let y=e.mutable_source(),w=e.mutable_source(),k=e.mutable_source(),D=Ce({x:0,y:0,z:1},{duration:75}),R=e.mutable_source();function p(g,U,V,M,P,B){return(g*V+M-P)/B/U}let F=e.mutable_source(0),q=e.mutable_source(null),C=null;function J(g,U){!g||!U||(e.get(q)?.destroy(),C?.disconnect(),g?.getBoundingClientRect().width,e.set(F,U?.getBoundingClientRect().width||0),e.set(q,new Je(U,g)),e.get(q).subscribe(({x:V,y:M,scale:P})=>{D.set({x:V,y:M,z:P})}),C=new ResizeObserver(V=>{for(const M of V)M.target===U&&e.set(F,M.contentRect.width),M.target===g&&M.contentRect.width}),C.observe(U),C.observe(g))}fe(()=>()=>{e.get(q)?.destroy(),C?.disconnect()});let f=e.mutable_source(),u=e.mutable_source({top:0,left:0,width:0,height:0});function S(g){e.set(u,g.detail)}e.legacy_pre_effect(()=>(e.deep_read_state(m()),e.get(F),e.get(u),r()),()=>{e.set(s,p(m(),e.get(F),e.get(u).width,e.get(u).left,r().x,r().z))}),e.legacy_pre_effect(()=>(e.deep_read_state(T()),e.get(s)),()=>{e.set(d,T()?`clip-path: inset(0 0 0 ${e.get(s)*100}%)`:"")}),e.legacy_pre_effect(()=>(e.get(y),e.get(w)),()=>{J(e.get(y),e.get(w))}),e.legacy_pre_effect_reset();var G={get value(){return o()},set value(g){o(g),e.flush()},get label(){return _()},set label(g){_(g),e.flush()},get show_download_button(){return Y()},set show_download_button(g){Y(g),e.flush()},get show_label(){return x()},set show_label(g){x(g),e.flush()},get i18n(){return z()},set i18n(g){z(g),e.flush()},get position(){return m()},set position(g){m(g),e.flush()},get layer_images(){return T()},set layer_images(g){T(g),e.flush()},get show_single(){return I()},set show_single(g){I(g),e.flush()},get slider_color(){return l()},set slider_color(g){l(g),e.flush()},get show_fullscreen_button(){return h()},set show_fullscreen_button(g){h(g),e.flush()},get fullscreen(){return v()},set fullscreen(g){v(g),e.flush()},get el_width(){return X()},set el_width(g){X(g),e.flush()},get max_height(){return $()},set max_height(g){$(g),e.flush()},get interactive(){return i()},set interactive(g){i(g),e.flush()}};e.init();var j=et(),K=e.first_child(j);{let g=e.derived_safe_equal(()=>(e.deep_read_state(_()),e.deep_read_state(z()),e.untrack(()=>_()||z()("image.image"))));xe(K,{get show_label(){return x()},get Icon(){return ue},get label(){return e.get(g)}})}var ee=e.sibling(K,2);{var te=g=>{ze(g,{unpadded_box:!0,size:"large",children:(U,V)=>{ue(U)},$$slots:{default:!0}})},ne=g=>{var U=Qe(),V=e.child(U);Le(V,{children:(L,Z)=>{var E=Ke(),W=e.first_child(E);{let O=e.derived_safe_equal(()=>(e.deep_read_state(z()),e.untrack(()=>z()("common.undo")))),Q=e.derived_safe_equal(()=>(r(),e.untrack(()=>r().z===1)));ie(W,{get Icon(){return Pe},get label(){return e.get(O)},get disabled(){return e.get(Q)},$$events:{click:()=>e.get(q)?.reset_zoom()}})}var A=e.sibling(W,2);{var H=O=>{$e(O,{get fullscreen(){return v()},$$events:{fullscreen(Q){e.bubble_event.call(this,t,Q)}}})};e.if(A,O=>{h()&&O(H)})}var N=e.sibling(A,2);{var se=O=>{{let Q=e.derived_safe_equal(()=>(e.deep_read_state(o()),e.untrack(()=>o()[1]?.url))),Ee=e.derived_safe_equal(()=>(e.deep_read_state(o()),e.untrack(()=>o()[1]?.orig_name||"image")));Ye(O,{get href(){return e.get(Q)},get download(){return e.get(Ee)},children:(De,gt)=>{{let Re=e.derived_safe_equal(()=>(e.deep_read_state(z()),e.untrack(()=>z()("common.download"))));ie(De,{get Icon(){return Xe},get label(){return e.get(Re)}})}},$$slots:{default:!0}})}};e.if(N,O=>{Y()&&O(se)})}var me=e.sibling(N,2);{var Te=O=>{ie(O,{get Icon(){return ke},label:"Remove Image",$$events:{click:Q=>{o([null,null]),b("clear"),Q.stopPropagation()}}})};e.if(me,O=>{i()&&O(Te)})}e.append(L,E)},$$slots:{default:!0}});var M=e.sibling(V,2);let P;var B=e.child(M);Me(B,{get slider_color(){return l()},get image_size(){return e.get(u)},get position(){return m()},set position(L){m(L)},get el(){return e.get(w)},set el(L){e.set(w,L)},get parent_el(){return e.get(R)},set parent_el(L){e.set(R,L)},children:(L,Z)=>{var E=Ze(),W=e.first_child(E);{let H=e.derived_safe_equal(()=>(e.deep_read_state(o()),e.untrack(()=>o()?.[0]?.url)));de(W,{get src(){return e.get(H)},alt:"",loading:"lazy",variant:"preview",get transform(){return`translate(${r(),e.untrack(()=>r().x)??""}px, ${r(),e.untrack(()=>r().y)??""}px) scale(${r(),e.untrack(()=>r().z)??""})`},get fullscreen(){return v()},get max_height(){return $()},get img_el(){return e.get(y)},set img_el(N){e.set(y,N)},$$events:{load:S},$$legacy:!0})}var A=e.sibling(W,2);{let H=e.derived_safe_equal(()=>(e.deep_read_state(o()),e.untrack(()=>!o()?.[1]?.url))),N=e.derived_safe_equal(()=>(e.deep_read_state(o()),e.untrack(()=>o()?.[1]?.url)));de(A,{variant:"preview",get fixed(){return T()},get hidden(){return e.get(H)},get src(){return e.get(N)},alt:"",loading:"lazy",get style(){return`${e.get(d)??""}; background: var(--block-background-fill);`},get transform(){return`translate(${r(),e.untrack(()=>r().x)??""}px, ${r(),e.untrack(()=>r().y)??""}px) scale(${r(),e.untrack(()=>r().z)??""})`},get fullscreen(){return v()},get max_height(){return $()},$$events:{load:S}})}e.append(L,E)},$$slots:{default:!0},$$legacy:!0}),e.reset(M),e.bind_this(M,L=>e.set(f,L),()=>e.get(f)),e.reset(U),e.bind_this(U,L=>e.set(k,L),()=>e.get(k)),e.template_effect(()=>P=e.set_class(M,1,"slider-wrap svelte-1880bc6",null,P,{limit_height:!v()})),e.bind_element_size(M,"clientWidth",X),e.append(g,U)};e.if(ee,g=>{e.deep_read_state(o()),e.deep_read_state(I()),e.untrack(()=>(o()===null||o()[0]===null||o()[1]===null)&&!I())?g(te):g(ne,!1)})}e.append(c,j);var he=e.pop(G);return n(),he}var rt=e.from_html('<div class="svelte-2ufkjh"><!></div>');function st(c,t){e.push(t,!1);const r=ce();e.init();var a=rt(),n=e.child(a);ie(n,{get Icon(){return ke},label:"Remove Image",$$events:{click:s=>{r("remove_image"),s.stopPropagation()}}}),e.reset(a),e.append(c,a),e.pop()}var it=e.from_html('<div class="icon-buttons svelte-1c8zs50"><!></div>'),at=e.from_html("<div><!></div>"),lt=e.from_html("<div><!></div>"),nt=e.from_html("<div><!> <!></div>"),ot=e.from_html('<!> <div data-testid="image" class="image-container svelte-1c8zs50"><!> <!> <!></div>',1);function ut(c,t){e.push(t,!1);let r=e.prop(t,"value",12),a=e.prop(t,"label",12,void 0),n=e.prop(t,"show_label",12),s=e.prop(t,"root",12),d=e.prop(t,"position",12),o=e.prop(t,"upload_count",12,2),_=e.prop(t,"show_download_button",12,!0),Y=e.prop(t,"slider_color",12),x=e.prop(t,"upload",12),z=e.prop(t,"stream_handler",12),m=e.prop(t,"max_file_size",12,null),T=e.prop(t,"i18n",12),I=e.prop(t,"max_height",12),l=e.prop(t,"upload_promise",12,null),h=e.mutable_source(r()||[null,null]),v=e.mutable_source(),X=e.mutable_source(),$=e.mutable_source();async function i({detail:u},S){const G=[r()[0],r()[1]];u.length>1?G[S]=u[0]:G[S]=u[S],r(G),await pe(),y("upload",G)}let b=e.mutable_source("");const y=ce();let w=e.prop(t,"dragging",12,!1);e.legacy_pre_effect(()=>(e.deep_read_state(r()),e.get(b)),()=>{JSON.stringify(r())!==e.get(b)&&(e.set(b,JSON.stringify(r())),e.set(h,r()))}),e.legacy_pre_effect(()=>e.deep_read_state(w()),()=>{y("drag",w())}),e.legacy_pre_effect_reset();var k={get value(){return r()},set value(u){r(u),e.flush()},get label(){return a()},set label(u){a(u),e.flush()},get show_label(){return n()},set show_label(u){n(u),e.flush()},get root(){return s()},set root(u){s(u),e.flush()},get position(){return d()},set position(u){d(u),e.flush()},get upload_count(){return o()},set upload_count(u){o(u),e.flush()},get show_download_button(){return _()},set show_download_button(u){_(u),e.flush()},get slider_color(){return Y()},set slider_color(u){Y(u),e.flush()},get upload(){return x()},set upload(u){x(u),e.flush()},get stream_handler(){return z()},set stream_handler(u){z(u),e.flush()},get max_file_size(){return m()},set max_file_size(u){m(u),e.flush()},get i18n(){return T()},set i18n(u){T(u),e.flush()},get max_height(){return I()},set max_height(u){I(u),e.flush()},get upload_promise(){return l()},set upload_promise(u){l(u),e.flush()},get dragging(){return w()},set dragging(u){w(u),e.flush()}};e.init();var D=ot(),R=e.first_child(D);{let u=e.derived_safe_equal(()=>(e.deep_read_state(a()),e.deep_read_state(T()),e.untrack(()=>a()||T()("image.image"))));xe(R,{get show_label(){return n()},get Icon(){return ue},get label(){return e.get(u)}})}var p=e.sibling(R,2),F=e.child(p);{var q=u=>{st(u,{$$events:{remove_image:()=>{d(.5),r([null,null]),y("clear")}}})};e.if(F,u=>{e.deep_read_state(r()),e.untrack(()=>r()?.[0]?.url||r()?.[1]?.url)&&u(q)})}var C=e.sibling(F,2);{var J=u=>{var S=it(),G=e.child(S);{var j=K=>{{let ee=e.derived_safe_equal(()=>(e.deep_read_state(r()),e.untrack(()=>r()[1].orig_name||"image")));Ye(K,{get href(){return e.deep_read_state(r()),e.untrack(()=>r()[1].url)},get download(){return e.get(ee)},children:(te,ne)=>{ie(te,{get Icon(){return Xe}})},$$slots:{default:!0}})}};e.if(G,K=>{_()&&K(j)})}e.reset(S),e.append(u,S)};e.if(C,u=>{e.deep_read_state(r()),e.untrack(()=>r()?.[1]?.url)&&u(J)})}var f=e.sibling(C,2);{let u=e.derived_safe_equal(()=>(e.deep_read_state(o()),e.deep_read_state(r()),e.untrack(()=>o()==2||!r()?.[0])));Me(f,{get disabled(){return e.get(u)},get slider_color(){return Y()},get position(){return d()},set position(S){d(S)},children:(S,G)=>{var j=nt();let K,ee;var te=e.child(j);{var ne=M=>{var P=at();let B;var L=e.child(P);{let Z=e.derived_safe_equal(()=>(e.deep_read_state(r()),e.untrack(()=>!!r()?.[0])));be(L,{filetype:"image/*",get disable_click(){return e.get(Z)},get root(){return s()},file_count:"multiple",get upload(){return x()},get stream_handler(){return z()},get max_file_size(){return m()},get upload_promise(){return l()},set upload_promise(E){l(E)},get dragging(){return w()},set dragging(E){w(E)},$$events:{load:E=>i(E,0)},children:(E,W)=>{var A=e.comment(),H=e.first_child(A);e.slot(H,t,"default",{},null),e.append(E,A)},$$slots:{default:!0},$$legacy:!0})}e.reset(P),e.template_effect(()=>B=e.set_class(P,1,"wrap svelte-1c8zs50",null,B,{"half-wrap":o()===1})),e.append(M,P)},he=M=>{{let P=e.derived_safe_equal(()=>(e.get(h),e.untrack(()=>e.get(h)[0]?.url)));de(M,{variant:"upload",get src(){return e.get(P)},alt:"",get max_height(){return I()},get img_el(){return e.get(v)},set img_el(B){e.set(v,B)},$$legacy:!0})}};e.if(te,M=>{e.get(h),e.untrack(()=>!e.get(h)?.[0])?M(ne):M(he,!1)})}var g=e.sibling(te,2);{var U=M=>{{let P=e.derived_safe_equal(()=>(e.deep_read_state(r()),e.untrack(()=>!!r()?.[1])));be(M,{filetype:"image/*",get disable_click(){return e.get(P)},get root(){return s()},file_count:"multiple",get upload(){return x()},get stream_handler(){return z()},get max_file_size(){return m()},get upload_promise(){return l()},set upload_promise(B){l(B)},get dragging(){return w()},set dragging(B){w(B)},$$events:{load:B=>i(B,1)},children:(B,L)=>{var Z=e.comment(),E=e.first_child(Z);e.slot(E,t,"default",{},null),e.append(B,Z)},$$slots:{default:!0},$$legacy:!0})}},V=M=>{var P=e.comment(),B=e.first_child(P);{var L=E=>{var W=lt();let A,H;var N=e.child(W);ze(N,{unpadded_box:!0,size:"large",children:(se,me)=>{ue(se)},$$slots:{default:!0}}),e.reset(W),e.template_effect(()=>{A=e.set_class(W,1,"empty-wrap fixed svelte-1c8zs50",null,A,{"white-icon":!r()?.[0]?.url}),H=e.set_style(W,"",H,{width:`${e.get(X)*(1-d())}px`,transform:`translateX(${e.get(X)*d()}px)`})}),e.append(E,W)},Z=E=>{var W=e.comment(),A=e.first_child(W);{var H=N=>{{let se=e.derived_safe_equal(()=>o()===1);de(N,{variant:"upload",get src(){return e.get(h),e.untrack(()=>e.get(h)[1].url)},alt:"",get fixed(){return e.get(se)},transform:"translate(0px, 0px) scale(1)",get max_height(){return I()}})}};e.if(A,N=>{e.get(h),e.untrack(()=>e.get(h)?.[1])&&N(H)},!0)}e.append(E,W)};e.if(B,E=>{e.get(h),e.deep_read_state(o()),e.untrack(()=>!e.get(h)?.[1]&&o()===1)?E(L):E(Z,!1)},!0)}e.append(M,P)};e.if(g,M=>{e.get(h),e.deep_read_state(o()),e.untrack(()=>!e.get(h)?.[1]&&o()===2)?M(U):M(V,!1)})}e.reset(j),e.template_effect(()=>{K=e.set_class(j,1,"upload-wrap svelte-1c8zs50",null,K,{"side-by-side":o()===2}),ee=e.set_style(j,"",ee,{display:o()===2?"flex":"block"})}),e.append(S,j)},$$slots:{default:!0},$$legacy:!0})}return e.reset(p),e.bind_element_size(p,"clientWidth",u=>e.set(X,u)),e.bind_element_size(p,"clientHeight",u=>e.set($,u)),e.append(c,D),e.pop(k)}function dt(c,t){e.push(t,!1);let r=e.prop(t,"value",28,()=>[null,null]),a=e.prop(t,"upload",12),n=e.prop(t,"stream_handler",12),s=e.prop(t,"label",12),d=e.prop(t,"show_label",12),o=e.prop(t,"i18n",12),_=e.prop(t,"root",12),Y=e.prop(t,"upload_count",12,1),x=e.prop(t,"dragging",12),z=e.prop(t,"max_height",12),m=e.prop(t,"max_file_size",12,null),T=e.prop(t,"upload_promise",12,null);var I={get value(){return r()},set value(l){r(l),e.flush()},get upload(){return a()},set upload(l){a(l),e.flush()},get stream_handler(){return n()},set stream_handler(l){n(l),e.flush()},get label(){return s()},set label(l){s(l),e.flush()},get show_label(){return d()},set show_label(l){d(l),e.flush()},get i18n(){return o()},set i18n(l){o(l),e.flush()},get root(){return _()},set root(l){_(l),e.flush()},get upload_count(){return Y()},set upload_count(l){Y(l),e.flush()},get dragging(){return x()},set dragging(l){x(l),e.flush()},get max_height(){return z()},set max_height(l){z(l),e.flush()},get max_file_size(){return m()},set max_file_size(l){m(l),e.flush()},get upload_promise(){return T()},set upload_promise(l){T(l),e.flush()}};return ut(c,{slider_color:"var(--border-color-primary)",position:.5,get root(){return _()},get label(){return s()},get show_label(){return d()},get upload_count(){return Y()},get stream_handler(){return n()},get upload(){return a()},get max_file_size(){return m()},get max_height(){return z()},get i18n(){return o()},get upload_promise(){return T()},set upload_promise(l){T(l)},get value(){return r()},set value(l){r(l)},get dragging(){return x()},set dragging(l){x(l)},$$events:{edit(l){e.bubble_event.call(this,t,l)},clear(l){e.bubble_event.call(this,t,l)},stream(l){e.bubble_event.call(this,t,l)},drag:({detail:l})=>x(l),upload(l){e.bubble_event.call(this,t,l)},select(l){e.bubble_event.call(this,t,l)},share(l){e.bubble_event.call(this,t,l)}},children:(l,h)=>{var v=e.comment(),X=e.first_child(v);e.slot(X,t,"default",{},null),e.append(l,v)},$$slots:{default:!0},$$legacy:!0}),e.pop(I)}var ct=e.from_html("<!> <!>",1),ht=e.from_html("<!> <!>",1);function Wt(c,t){e.push(t,!0);let r=e.state(void 0);class a extends Se{async get_data(){return e.get(r)&&(await e.get(r),await pe()),await super.get_data()}}const n=e.rest_props(t,["$$slots","$$events","$$legacy"]),s=new a(n);let d=e.state(e.proxy(s.props.value)),o=e.state(!1),_=e.state(!1),Y,x=e.derived(()=>Math.max(0,Math.min(100,s.props.slider_position))/100);e.user_effect(()=>{e.get(d)!=s.props.value&&(e.set(d,s.props.value,!0),s.dispatch("change"),s.dispatch("input"))});const z=v=>{const X=v;X.preventDefault(),X.stopPropagation(),X.type==="dragenter"||X.type==="dragover"?e.set(_,!0):X.type==="dragleave"&&e.set(_,!1)},m=v=>{if(s.shared.interactive){const X=v;X.preventDefault(),X.stopPropagation(),e.set(_,!1),Y&&Y.loadFilesFromDrop(X)}};var T=e.comment(),I=e.first_child(T);{var l=v=>{{let X=e.derived(()=>e.get(_)?"focus":"base"),$=e.derived(()=>s.props.height||void 0);ve(v,{get visible(){return s.shared.visible},variant:"solid",get border_mode(){return e.get(X)},padding:!1,get elem_id(){return s.shared.elem_id},get elem_classes(){return s.shared.elem_classes},get height(){return e.get($)},get width(){return s.props.width},allow_overflow:!1,get container(){return s.shared.container},get scale(){return s.shared.scale},get min_width(){return s.shared.min_width},get fullscreen(){return e.get(o)},set fullscreen(i){e.set(o,i,!0)},children:(i,b)=>{var y=ct(),w=e.first_child(y);we(w,e.spread_props({get autoscroll(){return s.shared.autoscroll},get i18n(){return s.i18n}},()=>s.shared.loading_status));var k=e.sibling(w,2);{let D=e.derived(()=>s.props.buttons.includes("download")),R=e.derived(()=>s.props.buttons.includes("fullscreen"));tt(k,{get fullscreen(){return e.get(o)},get interactive(){return s.shared.interactive},get label(){return s.shared.label},get show_label(){return s.shared.show_label},get show_download_button(){return e.get(D)},get i18n(){return s.i18n},get show_fullscreen_button(){return e.get(R)},get position(){return e.get(x)},get slider_color(){return s.props.slider_color},get max_height(){return s.props.max_height},get value(){return s.props.value},set value(p){s.props.value=p},$$events:{select:({detail:p})=>s.dispatch("select",p),share:({detail:p})=>s.dispatch("share",p),error:({detail:p})=>s.dispatch("error",p),clear:()=>s.dispatch("clear"),fullscreen:({detail:p})=>{e.set(o,p,!0)}}})}e.append(i,y)},$$slots:{default:!0}})}},h=v=>{{let X=e.derived(()=>s.props.value===null?"dashed":"solid"),$=e.derived(()=>e.get(_)?"focus":"base"),i=e.derived(()=>s.props.height||void 0);ve(v,{get visible(){return s.shared.visible},get variant(){return e.get(X)},get border_mode(){return e.get($)},padding:!1,get elem_id(){return s.shared.elem_id},get elem_classes(){return s.shared.elem_classes},get height(){return e.get(i)},get width(){return s.props.width},allow_overflow:!1,get container(){return s.shared.container},get scale(){return s.shared.scale},get min_width(){return s.shared.min_width},$$events:{dragenter:z,dragleave:z,dragover:z,drop:m},children:(b,y)=>{var w=ht(),k=e.first_child(w);we(k,e.spread_props({get autoscroll(){return s.shared.autoscroll},get i18n(){return s.i18n}},()=>s.shared.loading_status,{on_clear_status:()=>s.dispatch("clear_status",s.shared.loading_status)}));var D=e.sibling(k,2);{let R=e.derived(()=>s.shared.client?.stream);e.bind_this(dt(D,{get root(){return s.shared.root},get label(){return s.shared.label},get show_label(){return s.shared.show_label},get upload_count(){return s.props.upload_count},get max_file_size(){return s.shared.max_file_size},get i18n(){return s.i18n},upload:(...p)=>s.shared.client.upload(...p),get stream_handler(){return e.get(R)},get max_height(){return s.props.max_height},get upload_promise(){return e.get(r)},set upload_promise(p){e.set(r,p,!0)},get value(){return s.props.value},set value(p){s.props.value=p},get dragging(){return e.get(_)},set dragging(p){e.set(_,p,!0)},$$events:{edit:()=>s.dispatch("edit"),clear:()=>{s.dispatch("clear")},drag:({detail:p})=>e.set(_,p,!0),upload:()=>s.dispatch("upload"),error:({detail:p})=>{s.shared.loading_status&&(s.shared.loading_status.status="error"),s.dispatch("error",p)},close_stream:()=>{s.dispatch("close_stream","stream")}},children:(p,F)=>{var q=e.comment(),C=e.first_child(q);{var J=f=>{Be(f,{get i18n(){return s.i18n},type:"image",get placeholder(){return s.props.placeholder}})};e.if(C,f=>{f(J)})}e.append(p,q)},$$slots:{default:!0}}),p=>Y=p,()=>Y)}e.append(b,w)},$$slots:{default:!0}})}};e.if(I,v=>{!s.shared.interactive||s.props.value?.[1]&&s.props.value?.[0]?v(l):v(h,!1)})}e.append(c,T),e.pop()}export{Wt as default};
